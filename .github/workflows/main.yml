name: CI Pipeline for PowerShell Script

on:
  push:
    branches:
      - main  # Trigger on push to the 'main' branch (you can change this to your default branch)
  pull_request:
    branches:
      - main  # Trigger on pull request to the 'main' branch

jobs:
  validate-and-test:
    runs-on: ubuntu-latest  # Use an Ubuntu runner (change if using Windows)

    steps:
      - name: Checkout Repository
        uses: actions/checkout@v2

      - name: Set up PowerShell
        uses: PowerShell/PowerShell@v7.2.0 # Set up PowerShell on the runner

      - name: Install PowerShell Modules (if needed)
        run: |
          Install-Module -Name Pester -Force -Scope CurrentUser # Pester is a testing framework for PowerShell

      - name: Validate PowerShell Script
        run: |
          # Run any script validation commands (e.g., syntax check, style check)
          pwsh -Command "Get-Command ./HelloWorld.ps1"  # Replace with the script to validate

      - name: Run PowerShell Tests (optional)
        run: |
          # Run unit tests using Pester (if you have them)
          pwsh -Command "Invoke-Pester ./tests"

      - name: Display Output
        run: echo "CI pipeline completed successfully!"
